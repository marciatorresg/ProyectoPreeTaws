import{l as b,n as w,s as C,t as V,z as D}from"./chunk-RD4RCTBO.js";import{$a as f,Ba as v,Ga as g,Ka as p,Sa as s,Ta as l,Ua as i,Va as h,_a as m,gb as a,hb as _,ib as x,ua as u,wa as d}from"./chunk-FX33XUP3.js";import"./chunk-RW4GY4BD.js";function y(t,n){if(t&1&&(l(0,"div",5)(1,"h3"),a(2,"Vista previa:"),i(),h(3,"video",6),i()),t&2){let c=f();d(3),s("src",c.previewUrl,u)}}function M(t,n){if(t&1&&(l(0,"div",7)(1,"h3"),a(2,"Resultado:"),i(),l(3,"p"),a(4),i()()),t&2){let c=f();d(4),_(c.result)}}var O=(()=>{let n=class n{constructor(o){this.http=o,this.selectedVideo=null,this.previewUrl=null,this.result="",this.loading=!1,this.backendUrl="http://127.0.0.1:5000/detect-fire"}onVideoSelected(o){if(this.selectedVideo=o.target.files[0],!this.selectedVideo)return;let e=new FileReader;e.onload=()=>this.previewUrl=e.result,e.readAsDataURL(this.selectedVideo)}uploadVideo(){if(!this.selectedVideo)return;this.loading=!0;let o=new FormData;o.append("file",this.selectedVideo),console.log(this.selectedVideo),this.http.post(this.backendUrl,o).subscribe({next:e=>{this.result=`Fire Detected: ${e.fire_detected}, Smoke Detected: ${e.smoke_detected}`,console.log("Detecciones del video:",e.detections),this.loading=!1},error:e=>{console.error("Error al enviar video:",e),this.result="Error al enviar video.",this.loading=!1}})}};n.\u0275fac=function(e){return new(e||n)(v(C))},n.\u0275cmp=g({type:n,selectors:[["app-fire-detector"]],decls:8,vars:4,consts:[[1,"container"],["type","file","accept","video/*",3,"change"],["class","preview",4,"ngIf"],[3,"click","disabled"],["class","resultado",4,"ngIf"],[1,"preview"],["controls","",1,"preview-video",3,"src"],[1,"resultado"]],template:function(e,r){e&1&&(l(0,"div",0)(1,"h2"),a(2,"Detector de Fuego/Humo con Video Pregrabado"),i(),l(3,"input",1),m("change",function(F){return r.onVideoSelected(F)}),i(),p(4,y,4,1,"div",2),l(5,"button",3),m("click",function(){return r.uploadVideo()}),a(6),i(),p(7,M,5,1,"div",4),i()),e&2&&(d(4),s("ngIf",r.previewUrl),d(),s("disabled",!r.selectedVideo||r.loading),d(),x(" ",r.loading?"Analizando...":"Detectar en Video"," "),d(),s("ngIf",r.result))},dependencies:[w,b,V,D],styles:[".container[_ngcontent-%COMP%]{padding:1rem;color:#fff;text-align:center}.preview[_ngcontent-%COMP%]{margin-top:1rem}.preview-img[_ngcontent-%COMP%]{max-width:300px;margin-top:10px;border-radius:8px;box-shadow:0 0 10px #aaa}button[_ngcontent-%COMP%]{margin-top:1rem;padding:.5rem 1rem;font-weight:700;background-color:#f60;border:none;color:#fff;border-radius:5px;cursor:pointer}"]});let t=n;return t})();export{O as FireDetectorComponent};
